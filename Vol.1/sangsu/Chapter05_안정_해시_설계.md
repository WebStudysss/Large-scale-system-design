목적 : 수평 확장을 위한 해시 설계

수평확장 시 서버에 균등하게 배포해야 함

## 해시 키 재배치 문제

모듈러 해시 hash(key) % n 방식은 장애가 발생할 때 문제가 발생

n(서버의 수)에 종속적

## 안정 해시

안정 해시(Consistent hashing)는 서버와 키를 같은 해시 링에 배치해 키의 **시계방향 첫 가상노드**로 매핑한다.

노드 증감 시 재배치되는 키가 일부에 국한되어 **스케일 인/아웃에 안정적**이며, **좋은 해시 + 충분한 가상노드**를 쓰면 요청이 **거의 균등**하게 분배된다.

해시 함수의 **결정성** 덕분에(구성이 바뀌지 않는 한) **같은 유저 키는 항상 같은 서버**로 라우팅된다.

더 쉽게 설명하자면,

- 서버랑 키(유저ID)를 **같은 원형 자(해시 링)** 위에 놓는다.
- 키가 가리키는 지점에서 **시계방향 “첫 번째 서버표지(vnode)”** 가 담당 서버다.
- 서버가 늘어나거나 줄어도 **그 서버 주변 일부 키만 이동**한다 → 재배치 최소.

![해시링 (2)](https://github.com/user-attachments/assets/52f912f3-e9a9-42ba-9abd-dff91f97ea7b)
